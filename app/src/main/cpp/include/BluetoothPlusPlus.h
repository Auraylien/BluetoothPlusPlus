#ifndef BLUETOOTH_BLUETOOTHPLUSPLUS_H
#define BLUETOOTH_BLUETOOTHPLUSPLUS_H

#include <cstdint>
#include <sys/types.h>

#if defined(__aarch64__)
    #define LIBC_PATH_OLD           "/system/lib64/libc.so"
    #define LIBC_PATH_NEW           "/apex/com.android.runtime/lib64/bionic/libc.so"
    #define LIBRARY_PATH            "/system/system_ext/lib64/bluetooth_qti.so"
    #define SIGNATURE_GET_DEV_CLASS "\x48\x08\x00\xf0\x08\xed\x41\xf9\x09\x47\x83\x52\x00\x01\x09\x8b\xc0\x03\x5f\xd6"
    #define SIGNATURE_SET_DEV_CLASS "\x5e\x86\x00\xf8\xfd\x7b\xbe\xa9\xf3\x0b\x00\xf9\xfd\x03\x00\x91\x48\x08\x00\xf0\x08\xed\x41\xf9\x4a\x47\x83\x52\x09\x00\x40\x79\x0b\x08\x40\x39\x0c\x71\x74\x79\x0a\x69\x6a\x38\x89\x01\x09\x4a\x4a\x01\x0b\x4a\x29\x01\x0a\x2a\x3f\x3d\x00\x72\xa0\x01\x00\x54\x09\x08\x40\x39\x0a\x00\x40\x79\x4b\x47\x83\x52\xf3\x03\x00\xaa\x09\x69\x2b\x38\x0a\x71\x34\x79\xde\xcb\xfb\x97\x08\x00\x40\xf9\x00\x01\x3f\xd6\xa0\x00\x00\x36\xe0\x03\x13\xaa\xfa\xdb\x00\x94\xe0\x03\x1f\x2a\x02\x00\x00\x14\x80\x01\x80\x52\xf3\x0b\x40\xf9\xfd\x7b\xc2\xa8\x5e\x8e\x5f\xf8\xc0\x03\x5f\xd6"
#else
    #define LIBC_PATH_OLD           "/system/lib/libc.so"
    #define LIBC_PATH_NEW           "/apex/com.android.runtime/lib/bionic/libc.so"
    #define LIBRARY_PATH            "/system/system_ext/lib/libbluetooth_qti.so"
    #define SIGNATURE_GET_DEV_CLASS "\x48\x41\xf6\xb8\x11\x78\x44\x00\x68\x08\x44\x70\x47\x00\xbf\xd6\x24\x0c\x00\x80\xb5\x33\xf7\x11\xfc\xc1"
    #define SIGNATURE_SET_DEV_CLASS "\xb5\x04\x46\x0e\x48\x41\xf6\xb8\x16\x21\x46\x78\x44\x03\x22\x05\x68\xa8\x19\xbb\xf0\x12\xee\x68\xb1\x20\x88\x41\xf6\xba\x12\xa1\x78\xa9\x54\xa8\x53\x33\xf7\x2b\xfc\x00\x68\x80\x47\x20\xb1\x20\x46\x26\xf0\x22\xfc\x00\x20\x70\xbd\x0c\x20\x70\xbd\x00\xbf\x14\x25\x0c\x00\x03\x48\x41"
#endif

#define DEV_CLASS_LEN 3

typedef uint8_t dev_class_t[DEV_CLASS_LEN];

class BluetoothPlusPlus {
private:
    pid_t pid;
    long remoteBaseAddress;
    long scanSize;
    char* memory;

public:
    BluetoothPlusPlus();
    ~BluetoothPlusPlus();
    int readDeviceClass(void *deviceClass);
    int setDeviceClass(void *deviceClass);
};

#endif //BLUETOOTH_BLUETOOTHPLUSPLUS_H
